.. _read_phonopy:

=====================
Reading Phonopy Output
=====================

InterpolationData
-----------------

The force constants matrix and other required information can be read 
from a number of different files generated by Phonopy:

- ``FORCE_CONSTANTS``
- ``force_constants.hdf5``
- ``phonopy.yaml``
- ``phonopy_disp.yaml``

Non-force constants information can be found in:

- ``mesh.yaml``
- ``qpoints.yaml``

Note that more descriptive names may be used for each of these files,
since Phonopy defaults to a set same name for each output format and
there are currently no default Phonopy filename extensions. By default
Euphonic will search the path for a set of default phonopy names, and
kwargs can be used to specify any non-default filenames.

.. code-block:: py

    from euphonic.data.interpolation import InterpolationData

    path = './quartz/'
    idata = InterpolationData.from_phonopy(path)

By default Phonopy will not output a force constants file, which can
be acquired in three ways: 

- For ``FORCE_CONSTANTS`` use ``--write-fc`` or set ``WRITE_FC = .TRUE.``
  in the session config file ``<filename>.conf``.

- For ``force_constants.hdf5`` use ``--hdf5`` or ``HDF5 = .TRUE.``
  in addition to the above.

- For ``phonopy.yaml`` use ``--include-fc`` or ``INCLUDE_FC = .TRUE.``

Note that Phonopy can generate a ``compact`` or ``full`` matrix. Only
the ``compact`` version is required so it is converted automatically
on load.

There are other ways to generate force constants using extra Phonopy
scripts on certain calculator outputs. Please consult the documentation
for more information.


PhononData
----------

Frequencies and eigenvectors for PhononData are read from a ``mesh.yaml`` 
or a ``qpoints.yaml`` file.

.. code-block:: py

    from euphonic.data.phonon import PhononData

    path = './quartz/'
    pdata = PhononData.from_phonopy(path)

